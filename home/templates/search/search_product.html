
<style>
    .search-container {
        display: flex;
        width: 100%;
        max-width: 500px;
        margin: 0 auto;
    }

    #search-input {
        flex-grow: 1;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    #search-form button {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 10%;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 0.3s ease;

    }
    
    .modal-content {
        background-color: #ffffff;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 10px 36px 0px, rgba(0, 0, 0, 0.06) 0px 0px 0px 1px;
        margin: 5% auto;
        padding: 20px;
        border-radius: 8px;
        width: 90%;
        max-width: 70%;
        max-height: 80vh;
        overflow-y: auto;
        transform: translateY(-50px);
        transition: transform 0.3s ease;
    }
    
    .modal.show {
        opacity: 1;
    }
    
    .modal.show .modal-content {
        transform: translateY(0);
    }
    
    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }
    
    .close:hover,
    .close:focus {
        color: #000;
        text-decoration: none;
    }
    
    .product-item {
        display: flex;
        flex-wrap: wrap; /* Allow items to wrap to the next row */
        gap: 20px;
        border-bottom: 1px solid #eee;
        padding: 15px 0;
    }
    
    .product-image {
        flex: 0 0 200px;
        width: 200px; /* Fixed width for the image */
        min-width: 200px; /* Ensure minimum width for the image */
        margin-right: 20px; /* Spacing between image and details */
    }
    
    .product-image img {
        width: 100%;
        height: auto;
        object-fit: contain;
    }
    
    .product-details {
        flex: 1;
    }
    
    .product-item:last-child {
        border-bottom: none;
    }
    
    .product-item h3 {
        margin-top: 0;
        margin-bottom: 10px;
    }
    
    .product-item p {
        margin: 5px 0;
    }
    
    .product-item a {
        display: inline-block;
        margin-top: 10px;
        padding: 5px 10px;
        background-color: #007bff;
        color: white;
        text-decoration: none;
        border-radius: 4px;
    }
    
    .product-item a:hover {
        background-color: #0056b3;
    }
    @media (max-width: 576px) {
        .modal{
            top:15%;
        z-index: 1000;

        }
        .modal-content {
            padding:0.5rem;
            width: 95%;
            max-width: 100%;
            margin:0 auto;
        }
        .product-image img{
            
        }
    }
 
</style>

<!-- Search Input -->
<form id="search-form" class="form-inline my-2 my-lg-0">
    <div class="search-container">
        <input type="text" id="search-input" class="form-control" placeholder="Search products...">
        <button type="submit" class="btn btn-outline-success"><i class="fa-solid fa-magnifying-glass"></i></button>
    </div>
</form>

<!-- Search Modal -->
<div id="search-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Search Results</h2>
        <div id="modal-content" class="border rounded"></div>
    </div>
</div>

<script>
    const searchForm = document.getElementById('search-form');
    const searchInput = document.getElementById('search-input');
    const modal = document.getElementById('search-modal');
    const modalContent = document.getElementById('modal-content');
    const closeButton = document.querySelector('.modal-content .close');

    // Function to handle form submission and fetch products
    searchForm.addEventListener('submit', async (event) => {
        event.preventDefault();
        const searchQuery = searchInput.value.trim();
        if (searchQuery) {
            const response = await fetch(`/api/laptop-specs/?q=${encodeURIComponent(searchQuery)}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            const laptops = await response.json();
            displaySearchResults(laptops);
        }
    });

    // Function to display search results in modal
    function displaySearchResults(laptops) {
        modalContent.innerHTML = '';
    
        const searchQuery = searchInput.value.trim().toLowerCase();
    
        if (laptops.length === 0) {
            modalContent.innerHTML = '<p>No laptops found.</p>';
        } else {
            const filteredLaptops = laptops.filter(laptop => {
                // Customize the filter logic based on your specific search requirements
                return (
                    laptop.product.name.toLowerCase().includes(searchQuery) ||
                    laptop.cpu.cpu_brand.name.toLowerCase().includes(searchQuery) ||
                    laptop.gpu.some(g => g.gpu_brand.name.toLowerCase().includes(searchQuery)) ||
                    laptop.memory.type.toLowerCase().includes(searchQuery) ||
                    laptop.storage.type.toLowerCase().includes(searchQuery)
                );
            });
    
            if (filteredLaptops.length === 0) {
                modalContent.innerHTML = `<p>No products found for "${searchQuery}".</p>`;
            } else {
                filteredLaptops.forEach(laptop => {
                    const laptopElement = document.createElement('div');
                    laptopElement.className = 'product-item';
                    laptopElement.innerHTML = `
                        <div class="product-image">
                            <img src="${laptop.product.images[0].image}" alt="${laptop.product.name}">
                        </div>
                        <div class="product-details">
                            <h3>${laptop.product.name} ${laptop.product.model} ${laptop.product.year}</h3>
                            <p><strong></strong> ${laptop.cpu.cpu_brand.name} ${laptop.cpu.model}, ${laptop.gpu.map(g => `${g.gpu_brand.name} ${g.model}`).join(', ')}, ${laptop.memory.capacity}GB ${laptop.memory.type}, ${laptop.storage.capacity} ${laptop.storage.capacity_type} ${laptop.storage.type}</p>
                            <p class="text-danger">$${laptop.product.price}</p>
                            <a href="/products/${laptop.slug}/">View Details</a>
                        </div>
                    `;
                    modalContent.appendChild(laptopElement);
                });
            }
        }
    
        openModal();
    }
    

    // Function to open modal
    function openModal() {
        modal.style.display = 'block';
        setTimeout(() => {
            modal.classList.add('show');
        }, 10);
    }

    // Function to close modal
    function closeModal() {
        modal.classList.remove('show');
        setTimeout(() => {
            modal.style.display = 'none';
        }, 300);
    }

    // Close the modal when clicking on the close button
    closeButton.addEventListener('click', closeModal);

    // Close the modal when clicking outside of it
    window.addEventListener('click', (event) => {
        if (event.target === modal) {
            closeModal();
        }
    });
</script>